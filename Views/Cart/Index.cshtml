@using Resturant_Menu.Controllers
@model List<CartItemDetail>
@{
    ViewData["Title"] = "Shopping Cart";
}
<link rel="stylesheet" href="~/css/cart/cart.css" asp-append-version="true" />

<div class="cart-wrapper">
    <!-- Header -->
    <div class="cart-header">
        <div class="header-container">
            <a href="@Url.Action("Index", "Menu")" class="back-link">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <path d="M12 4L6 10L12 16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
                <span>Continue Shopping</span>
            </a>
            <div class="header-content">
                <h1 class="cart-title">Your Cart</h1>
                <p class="cart-count">@(Model.Count == 0 ? "No items" : Model.Count == 1 ? "1 item" : $"{Model.Count} items")</p>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="cart-container">
        @if (Model.Count == 0)
        {
            <!-- Empty State -->
            <div class="empty-cart">
                <div class="empty-icon">
                    <svg width="120" height="120" viewBox="0 0 120 120" fill="none">
                        <circle cx="60" cy="60" r="55" stroke="currentColor" stroke-width="3" stroke-dasharray="8 8"/>
                        <path d="M40 50C40 50 45 45 60 45C75 45 80 50 80 50M48 70C48 70 52 66 60 66C68 66 72 70 72 70" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
                        <circle cx="48" cy="55" r="4" fill="currentColor"/>
                        <circle cx="72" cy="55" r="4" fill="currentColor"/>
                    </svg>
                </div>
                <h2 class="empty-title">Your cart is empty</h2>
                <p class="empty-description">Discover our delicious menu and add items to get started</p>
                <a href="@Url.Action("Index", "Menu")" class="btn-empty">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M3 4H17M3 8H17M3 12H17" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    <span>Browse Menu</span>
                </a>
            </div>
        }
        else
        {
            <div class="cart-layout">
                <!-- Cart Items -->
                <div class="cart-items-section">
                    <div class="items-header">
                        <h2 class="section-title">Cart Items</h2>
                        <span class="items-count">@Model.Count item@(Model.Count != 1 ? "s" : "")</span>
                    </div>

                    <div class="cart-items">
                        @foreach (var item in Model)
                        {
                            <div class="cart-item">
                                <div class="item-image-wrapper">
                                    @if (!string.IsNullOrWhiteSpace(item.ImageUrl))
                                    {
                                        <img src="@item.ImageUrl" alt="@item.Name" class="item-image" />
                                    }
                                    else
                                    {
                                        <div class="item-image-placeholder">
                                            <svg width="40" height="40" viewBox="0 0 40 40" fill="none">
                                                <rect x="8" y="10" width="24" height="20" rx="2" stroke="currentColor" stroke-width="2"/>
                                                <circle cx="14" cy="16" r="2" fill="currentColor"/>
                                                <path d="M8 24L14 18L18 22L26 14L32 20" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                            </svg>
                                        </div>
                                    }
                                </div>

                                <div class="item-details">
                                    <h3 class="item-name">@item.Name</h3>
                                    <p class="item-price">$@item.Price.ToString("F2") <span class="price-unit">each</span></p>
                                    
                                    <div class="item-actions">
                                        <form method="post" action="@Url.Action("UpdateQuantity", "Cart")" class="quantity-form">
                                            <input type="hidden" name="menuItemId" value="@item.MenuItemId" />
                                            <div class="quantity-control">
                                                <label class="quantity-label">Quantity:</label>
                                                <div class="quantity-input-group">
                                                    <input type="number" name="quantity" value="@item.Quantity" min="1" max="99" class="quantity-input" />
                                                    <button type="submit" class="btn-update">
                                                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                                            <path d="M13 3L6 10L3 7" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                                        </svg>
                                                        Update
                                                    </button>
                                                </div>
                                            </div>
                                        </form>

                                        <form method="post" action="@Url.Action("RemoveFromCart", "Cart")" class="remove-form">
                                            <input type="hidden" name="menuItemId" value="@item.MenuItemId" />
                                            <button type="submit" class="btn-remove">
                                                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                                    <path d="M2 4H14M6 4V3C6 2.44772 6.44772 2 7 2H9C9.55228 2 10 2.44772 10 3V4M5 4V13C5 13.5523 5.44772 14 6 14H10C10.5523 14 11 13.5523 11 13V4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                                </svg>
                                                Remove
                                            </button>
                                        </form>
                                    </div>
                                </div>

                                <div class="item-subtotal">
                                    <span class="subtotal-label">Subtotal</span>
                                    <span class="subtotal-value">$@item.Subtotal.ToString("F2")</span>
                                </div>
                            </div>
                        }
                    </div>
                </div>

                <!-- Order Summary -->
                <div class="cart-summary-section">
                    <div class="summary-card">
                        <h2 class="summary-title">Order Summary</h2>

                        <div class="summary-details">
                            <div class="summary-divider"></div>

                            <div class="summary-row summary-total">
                                <span class="row-label">Total</span>
                                <span class="row-value">$@Model.Sum(x => x.Subtotal).ToString("F2")</span>
                            </div>
                        </div>

                        <div class="summary-actions">
                            <a href="@Url.Action("Create", "Booking")" class="btn-checkout">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                    <rect x="3" y="4" width="14" height="14" rx="2" stroke="currentColor" stroke-width="2"/>
                                    <path d="M7 2V6M13 2V6M3 8H17" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                </svg>
                                <span>Proceed to Booking</span>
                            </a>
                            
                            <a href="@Url.Action("Index", "Menu")" class="btn-continue">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                    <path d="M3 4H17M3 8H17M3 12H17" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                </svg>
                                <span>Add More Items</span>
                            </a>
                        </div>

                        <!-- Additional Info -->
                        <div class="summary-info">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-width="2"/>
                                <path d="M8 4V8L11 11" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                            <span>Items prepared fresh to order</span>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>
</div>
